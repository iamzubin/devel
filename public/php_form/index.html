
<link rel="stylesheet" href="form.css">

<div class="imagebg"></div>
    	<div class="container">
    		<div class="form-container z-depth-5">
    			<h3>Contact Form</h3>
    			<div class="row">
			    <form class="col s12" id="reused_form">
			      <div class="row">
			        <div class="input-field col s12">
			          <input id="name" type="text" name="name" required class="validate">
			          <label for="name">Name</label>
			        </div>
			      </div>
			      <div class="row">
			        <div class="input-field col s12">
			          <input id="email" type="email" name="email" required class="validate">
			          <label for="email">Email</label>
			        </div>
			      </div>
			      <div class="row">
			        <div class="input-field col s12">
			          <textarea id="message" name="message" class="materialize-textarea" class="validate"
			          ></textarea>
			          <label for="message">Message</label>
			        </div>
			      </div>
			       <div>
				    	<button class="waves-effect waves-light btn submitbtn" type="submit">Submit</button>
				    </div>
			    </form>
			    <div id="error_message" style="width:100%; height:100%; display:none; ">
		            <h4>Error</h4>
		            Sorry there was an error sending your form.
			    </div>
			    <div id="success_message" style="width:100%; height:100%; display:none; ">
					<h4>Success! Your Message was Sent Successfully.</h4>
			    </div>
			  </div>
    		</div>
    	</div>
      <!--Import jQuery before materialize.js-->

      <script>
        $(function()
        {
            function after_form_submitted(data)
            {
                if(data.result == 'success')
                {
                    $('form#reused_form').hide();
                    $('#success_message').show();
                    $('#error_message').hide();
                }
                else
                {
                    $('#error_message').append('<ul></ul>');

                    jQuery.each(data.errors,function(key,val)
                    {
                        $('#error_message ul').append('<li>'+key+':'+val+'</li>');
                    });
                    $('#success_message').hide();
                    $('#error_message').show();

                    //reverse the response on the button
                    $('button[type="button"]', $form).each(function()
                    {
                        $btn = $(this);
                        label = $btn.prop('orig_label');
                        if(label)
                        {
                            $btn.prop('type','submit' );
                            $btn.text(label);
                            $btn.prop('orig_label','');
                        }
                    });

                }//else
            }

            $('#reused_form').submit(function(e)
              {
                e.preventDefault();

                $form = $(this);
                //show some response on the button
                $('button[type="submit"]', $form).each(function()
                {
                    $btn = $(this);
                    $btn.prop('type','button' );
                    $btn.prop('orig_label',$btn.text());
                    $btn.text('Sending ...');
                });


                            $.ajax({
                        type: "POST",
                        url: 'handler.php',
                        data: $form.serialize(),
                        success: after_form_submitted,
                        dataType: 'json'
                    });

              });
        });
        </script>

      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/js/materialize.min.js"></script>